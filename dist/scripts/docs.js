(()=>{"use strict";var e={};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p,e.p;var n={},r=document.getElementById("username").getAttribute("data-username"),o=document.querySelector(".dashboard__empty-message > p");function a(){document.body.style.overflow="scroll",document.querySelector("#preview").style.display="none",document.querySelector("#edit").style.display="none"}fetch("http://localhost:3000/docs/all").then((function(e){return e.json()})).then((function(e){e.result.reverse(),void 0!==e.result[0]&&function(e){document.getElementById("totalDocs").innerText=e.length;var o=document.querySelector(".dashboard__documents");document.querySelector(".dashboard__empty-message").style.display="none",o.setAttribute("class","dashboard__documents dashboard__documents--full");var c,i=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){d=!0,c=e},f:function(){try{i||null==r.return||r.return()}finally{if(d)throw c}}}}(e);try{var d=function(){var e=c.value,t=document.createElement("div");n[e._id]={creator:e.creator,title:e.title,body:e.main,date:e.dateMade,writers:e.writers},t.setAttribute("data-id",e._id);var i=document.createElement("div"),d=document.createElement("div");i.setAttribute("class","text");var l=document.createElement("div");l.setAttribute("class","options");var u=document.createElement("i");u.setAttribute("class","fas fa-pen"),u.addEventListener("click",(function(){var e=n[t.getAttribute("data-id")];e.writers.includes(r)?(document.querySelector("#edit-but").onclick=function(){t.getElementsByTagName("h1")[0].innerText=document.querySelector("#edit-title").value,t.getElementsByTagName("p")[0].innerText=document.querySelector("#edit-body").value,a(),e.title=document.querySelector("#edit-title").value,e.body=document.querySelector("#edit-body").value,fetch("http://localhost:3000/docs/edit",{method:"POST",body:JSON.stringify({id:t.getAttribute("data-id"),title:document.querySelector("#edit-title").value,main:document.querySelector("#edit-body").value})}).then((function(){toggleMessage("Document was successfully updated!",!0)})).catch((function(e){console.log(e)}))},function(e,t,n){document.querySelector("#edit").style.display="block",document.querySelector("#edit-title").value=e,document.querySelector("#edit-body").value=t}(e.title,e.body)):toggleMessage("You don't have permission to edit this document!",!1)}));var s=document.createElement("i");s.addEventListener("click",(function(){var e=s.parentElement.parentElement.getAttribute("data-id"),t=n[e];!function(e,t,n){document.body.style.overflow="hidden",document.querySelector("#preview").style.display="block",document.querySelector("#pre-title").innerText=e,document.querySelector("#pre-date").innerText=n,document.querySelector("#pre-body").innerText=t}(t.title,t.body,t.date.slice(0,10))})),s.setAttribute("class","fas fa-eye");var m=document.createElement("i");function y(){var e=m.parentElement.parentElement;document.querySelector(".dashboard__documents").removeChild(e),delete n[e.getAttribute("data-id")],document.querySelector("#totalDocs").innerText=Object.keys(n).length,0===Object.keys(n).length&&(document.querySelector("#totalDocs").innerText="",document.querySelector(".dashboard__documents").setAttribute("class","dashboard__documents dashboard__documents--empty"),document.querySelector(".dashboard__empty-message").style.display="initial",document.querySelector(".dashboard__empty-message").style.top="0")}for(var p in m.setAttribute("class","fas fa-trash"),m.addEventListener("click",(function(){n[m.parentElement.parentElement.getAttribute("data-id")].creator==r?window.confirm("Delete this document?")&&(y(),fetch("http://localhost:3000/docs/delete",{method:"POST",body:JSON.stringify({id:m.parentElement.parentElement.getAttribute("data-id")})}),toggleMessage("Document was successfully deleted!")):window.confirm("Remove this document?")&&(y(),fetch("http://localhost:3000/docs/delete",{method:"POST",body:JSON.stringify({username:r,id:m.parentElement.parentElement.getAttribute("data-id")})}),toggleMessage("Document was successfully removed!"))})),l.appendChild(u),l.appendChild(s),l.appendChild(m),e)if("title"==p){var f=document.createElement("h1");f.innerText=e[p],i.appendChild(f),i.appendChild(document.createElement("br"))}else if("main"==p){var h=document.createElement("p");h.innerText=e[p].length<200?e[p]:e[p].slice(0,181)+"...",d.appendChild(h),i.appendChild(d)}t.setAttribute("class","doc"),t.appendChild(i),t.appendChild(l),o.appendChild(t)};for(i.s();!(c=i.n()).done;)d()}catch(e){i.e(e)}finally{i.f()}}(e.result),o.innerText="You don't have any documents!"})),document.querySelectorAll(".preview-exit").forEach((function(e){e.onclick=a}))})();